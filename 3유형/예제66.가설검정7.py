■ 예제66. 가설검정7.세 모집단 이상의 모평균 차이 검정 (ANOVA)


가설검정
 ├─ 정규분포를 따르는 경우
 │   ├─ 단일 모집단의 모평균 검정
 │   │    ├─ 분산을 아는 경우  →  Z 검정   
 │   │    └─ 분산을 모르는 경우 →  t 검정 
 │   ├─ 두 모집단의 모평균 차이 검정
 │   │    ├─ 독립 표본         →  t 검정  
 │   │    └─ 대응 표본         →  t 검정
 │   └─ 세 모집단 이상의 모평균 차이 검정
 │        → ANOVA             <---  😊 이 부분을 하고 있어요
 └─ 정규분포를 따르지 않는 경우
      → 비모수적 가설 검정

--------------------------------

[다변량분산분석(ANOVA) 이론 정리]

## 분석 기법 요약

| 분석 기법  | 독립변수 개수 | 종속변수 개수 | 분석 목적 |
|------------|--------------|--------------|----------|
| One-way ANOVA | 1개 | 1개 | 한 개의 요인이 종속변수에 미치는 영향 분석 |
| Two-way ANOVA | 2개 | 1개 | 두 개의 요인이 종속변수에 미치는 개별적 & 상호작용 효과 분석 |
| MANOVA | 1개 이상 | 2개 이상 | 여러 종속변수를 동시에 고려하여 분석 |

## 정의

- **ANOVA(분산분석)**: 두 개 이상의 모집단(또는 집단) 간의 평균 차이가 통계적으로 유의한지를 검정하는 방법.
- **One-way ANOVA(일원배치 분산분석)**: 하나의 독립변수(요인)에 따른 한 개의 종속변수의 평균 차이를 검정하는 방법.
- **Two-way ANOVA(이원배치 분산분석)**: 두 개의 독립변수가 한 개의 종속변수에 미치는 개별적 & 상호작용 효과를 분석하는 방법.
- **MANOVA(다변량 분산분석)**: 하나 이상의 독립변수를 대상으로 여러 개의 종속변수에 대해 동시에 평균 차이를 검정하는 방법.

## 주요 특징 및 가정

- **One-way ANOVA**:
  - 독립변수: 1개, 종속변수: 1개
  - 모집단 분산을 알지 못할 때 사용
  - 각 그룹의 관측치는 독립적이며, 정규성을 가정하고, 그룹 간 분산은 동질적(동분산성)이라는 가정을 전제로 함.

- **Two-way ANOVA**:
  - 독립변수: 2개, 종속변수: 1개
  - 두 개의 독립변수가 개별적으로 또는 조합하여 종속변수에 미치는 영향을 분석
  - 그룹 간 분산의 동질성을 가정

- **MANOVA**:
  - 독립변수: 1개 이상, 종속변수: 여러 개
  - 각 종속변수들이 상호 연관되어 있을 때, 이를 동시에 고려하여 집단 간 차이를 검정
  - 종속변수 간의 공분산 구조를 고려해야 함

## 쉽게 말하면

- **One-way ANOVA**: "수면 시간이 시험 성적에 영향을 줄까?"
- **Two-way ANOVA**: "수면 시간과 학습 방법이 시험 성적에 영향을 줄까?" (그리고 둘의 조합이 영향을 줄까?)
- **MANOVA**: "수면 시간과 학습 방법이 시험 성적뿐만 아니라 스트레스에도 영향을 줄까?"


--------------------------------
[기출문제 정리]

● 2024년 제8회 빅데이터분석기사 필기
   - 문제:
         다변량분산분석(ANOVA)에 대한 설명으로 옳은 것은?
         선택지:
           1) 독립변수 1개, 종속변수 여러 개
           2) 독립변수 여러 개, 종속변수 1개
           3) 독립변수 1개 이상, 종속변수 여러 개
           4) 독립변수와 종속변수 모두 여러 개

   - 정답: 
 
● 2022년 제4회 빅데이터분석기사 필기
   - 문제:
         통계에서 평균에 대한 차이검정으로 모집단 3개 이상 사용하는 분석방법으로 가장 알맞은 것은?
         선택지:
           1) t검정
           2) z검정
           3) 분산분석
           4) 상관분석

   - 정답:  



--------------------------------
[파이썬 코드 예제: 일원배치 ANOVA]
문제: 수면 시간과 시험 성적의 관계 분석
한 연구팀은 학생들의 수면 시간이 시험 성적에 미치는 영향을 분석하려고 한다.
학생들을 3개의 그룹으로 나누고, 각 그룹의 평균 시험 성적이 통계적으로 유의미한 차이가 있는지 일원배치 분산분석(One-way ANOVA) 을 수행하였다.

실험 그룹:
5~6시간 수면 그룹: 68, 72, 65, 70, 67
7~8시간 수면 그룹: 85, 88, 82, 90, 84
9~10시간 수면 그룹: 75, 72, 78, 74, 73
 
질문:
일원배치 ANOVA의 귀무가설(H₀)과 대립가설(H₁)은 무엇인가?
F 검정 통계량과 p-value를 구하고, 유의 수준 α=0.05에서 귀무가설을 기각할 수 있는가?
귀무가설을 기각할 경우, 사후 검정(Tukey HSD)을 통해 어떤 그룹 간 유의미한 차이가 있는지 분석하라.
수면 시간별 시험 성적의 분포를 박스플롯(Boxplot)으로 시각화하라.

 import numpy as np
from scipy import stats
import matplotlib.pyplot as plt

# 한글 폰트 설정
plt.rc('font', family='Malgun Gothic')  # 윈도우 사용자
plt.rcParams['axes.unicode_minus'] = False  # 마이너스 기호 깨짐 방지

# 1. 가설 설정
H0 = "세 수면 시간 그룹의 평균 시험 성적은 차이가 없다."
H1 = "적어도 하나의 수면 시간 그룹에서 평균 시험 성적이 유의하게 다르다."

# 2. 데이터 생성 (수면 시간에 따른 시험 성적)
sleep_5to6h = np.array([68, 72, 65, 70, 67])
sleep_7to8h = np.array([85, 88, 82, 90, 84])
sleep_9to10h = np.array([75, 72, 78, 74, 73])



--------------------------------
[파이썬 문제: 일원배치 ANOVA를 이용한 다이어트 요법 효과 비교]

문제 설명:
  한 연구에서 세 가지 다른 다이어트 요법(A, B, C)이 체중 감량에 미치는 영향을 비교하고자 합니다.
  각 다이어트 그룹에서 10명의 참가자를 선정하여 체중 감량(kg)을 측정하였습니다.
  
  다이어트 A: [3.2, 2.8, 3.5, 3.0, 3.1, 2.9, 3.3, 3.0, 2.7, 3.4]
  다이어트 B: [2.5, 2.7, 2.8, 2.4, 2.6, 2.5, 2.9, 2.7, 2.8, 2.6]
  다이어트 C: [3.6, 3.7, 3.5, 3.8, 3.6, 3.9, 3.7, 3.8, 3.6, 3.7]

  유의수준 α = 0.05에서, 세 그룹 간의 평균 체중 감량에 유의한 차이가 있는지
  일원배치 분산분석(One-way ANOVA)을 이용하여 검정하시오.
  
--------------------------------

import numpy as np
from scipy import stats
import matplotlib.pyplot as plt

# 한글 폰트 설정
plt.rc('font', family='Malgun Gothic')  # 윈도우 사용자
plt.rcParams['axes.unicode_minus'] = False  # 마이너스 기호 깨짐 방지

# 1. 가설 설정
H0 = "세 다이어트 그룹의 평균 체중 감량은 차이가 없다."
H1 = "적어도 하나의 다이어트 그룹에서 평균 체중 감량이 유의하게 다르다."

# 2. 데이터 생성 (다이어트 A, B, C 그룹의 체중 감량 kg)
diet_A = np.array([3.2, 2.8, 3.5, 3.0, 3.1, 2.9, 3.3, 3.0, 2.7, 3.4])
diet_B = np.array([2.5, 2.7, 2.8, 2.4, 2.6, 2.5, 2.9, 2.7, 2.8, 2.6])
diet_C = np.array([3.6, 3.7, 3.5, 3.8, 3.6, 3.9, 3.7, 3.8, 3.6, 3.7])



