■■ 예제59.다중회귀_분석.py

"""
📌 다중 회귀분석(Multiple Linear Regression) 정리
"""

=============================================================================
📌 1. 다중 회귀분석이란?
=============================================================================
- 하나의 종속변수(Y)와 두 개 이상의 독립변수(X₁, X₂, ..., Xₙ) 간의 관계를 분석하는 회귀 모델.
- 단순 선형 회귀보다 복잡한 관계를 설명하고, 더 높은 예측력을 제공함.
- 회귀식:
  
  Y = a₁X₁ + a₂X₂ + ... + aₙXₙ + b  

- a₁, a₂, ..., aₙ: 독립변수들의 회귀계수 (각 변수의 영향력)
- b: 절편 (Intercept)
- 다중 회귀분석에서는 각 독립변수가 종속변수에 미치는 영향을 고려하여 최적의 회귀식을 도출함.

=============================================================================
📌 2. 다중 회귀분석의 가정 (Assumptions)
=============================================================================
✅ 선형성 (Linearity)  
  - 독립변수(X)와 종속변수(Y) 간에 선형 관계가 존재해야 함.  

✅ 독립성 (Independence)  
  - 각 데이터 포인트의 잔차(오차)들은 서로 독립적이어야 함.  

✅ 등분산성 (Homoscedasticity)  
  - 오차(잔차)의 분산이 일정해야 함.  

✅ 정규성 (Normality)  
  - 잔차가 정규분포를 따라야 함.  

✅ 다중공선성 없음 (No Multicollinearity)  
  - 독립변수들 간의 상관관계가 너무 높으면 모델이 불안정해짐.  
  - 분산팽창계수(VIF, Variance Inflation Factor)를 활용하여 다중공선성을 확인함.  

=============================================================================
📌 3. 다중 회귀분석 모델의 평가 방법
=============================================================================
✅ 결정계수(R²)  
  - 모델이 종속변수를 얼마나 잘 설명하는지 나타내는 지표.  
  - 값이 1에 가까울수록 좋은 모델.  

✅ 수정된 결정계수(Adjusted R²)  
  - 변수의 개수에 따른 R² 조정값.  
  - 독립변수 개수가 많아지면 일반 R²는 증가하지만, 모델의 성능이 반드시 좋아지는 것은 아님.  
  - 수정된 R²는 불필요한 변수가 추가되면 패널티를 부과함.  

✅ p-value  
  - 회귀계수가 유의미한지 확인하는 값.  
  - 일반적으로 p-value < 0.05이면 해당 독립변수가 유의미함.  

✅ F-검정 (F-test)  
  - 전체 회귀모델이 유의미한지 검정하는 방법.  

✅ 다중공선성 검토 (Multicollinearity Check)  
  - 독립변수 간 상관관계를 확인하여 다중공선성이 있는 경우 해결 필요.  
  - 분산팽창계수(VIF)를 사용하여 VIF 값이 10 이상이면 다중공선성이 높다고 판단.  

=============================================================================
📌 4. 다중 회귀분석 모델의 해석
=============================================================================
- 회귀계수(a₁, a₂, ..., aₙ)의 부호와 크기를 분석하여 독립변수가 종속변수에 미치는 영향을 평가함.  
- p-value가 낮은 변수는 종속변수에 유의미한 영향을 미치는 변수임.  
- 모델의 성능을 높이기 위해 변수 선택 방법(전진 선택법, 후진 제거법, 단계적 선택법)을 활용할 수 있음.  

=============================================================================
📌 5. 다중 회귀분석 실습 예제 (구현 부분은 직접 작성 가능)
=============================================================================
- 데이터를 준비하고, 다중 회귀 모델을 학습한 후 평가하는 과정 포함.  
- 다중공선성 문제를 해결하는 방법 검토.  
- 모델의 성능을 개선하기 위한 변수 선택 기법 적용.  

(코드 작성 영역)



문제1. 다중공선성과 VIF에 대한 설명으로 옳은 것은?
     (2024년 제8회 빅데이터분석기사 필기)

  1. VIF가 1보다 작으면 다중공선성이 있다
  2. 다중회귀에서 독립변수 간 선형관계가 있으면 다중공선성이 있다
  3. 다중공선성이 있어도 예측에는 문제가 없다
  4. VIF가 5 이하면 다중공선성이 없다고 본다

정답: 


문제2. 다중회귀분석에서 결정계수(R²)에 대한 설명으로 틀린 것은?
      (2023년 제6회 빅데이터분석기사 필기)

  1. 결정계수는 1에 가까울수록 좋으나, 무조건 크다고 좋은 것은 아니다
  2. 결정계수는 전체 변동 중 회귀식이 설명 불가능한 변동의 비율이다
  3. 결정계수는 SSR/SST로 구할 수 있다
  4. 다중회귀분석에서 모델 선택 시 수정 결정계수도 함께 고려할 필요가 있다

정답: 


문제3. 다중회귀분석에서 독립변수 간 선형관계가 존재하여 회귀식이 오류를 범할 수 있는 것은?
      (2022년 제4회 빅데이터분석기사 필기)

 1. 이상치
 2. 등분산성
 3. 다중공선성
 4. 독립성

정답: 


■ 실습1.

# ➡️ 미국민 의료비를 예측하는 다중 회귀 모델 생성하기
# 
# #1. 데이터를 불러옵니다.
# #2. 데이터를 살펴봅니다.
# #3. 다중회귀 분석 모델을 생성합니다.
# #4. 회귀분석 결과를 해석합니다.
# #5. 회귀분석 모델의 성능을 높입니다. 


# #1. 데이터를 불러옵니다.
ins = pd.read_csv("insurance.csv")








■ 문제1. 우주 왕복선 데이터를 다중회귀분석하여 o형링 파손에 
         가장 큰 영향을 주는 독립변수가 무엇인지 출력하시오 



