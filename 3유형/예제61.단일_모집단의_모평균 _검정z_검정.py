예제61.가설검정2.단일 모집단의 모평균 검정: 분산을 아는 경우(Z 검정)

■ [가설검정 전체 ]

가설검정
 ├─ 정규분포를 따르는 경우
 │   ├─ 단일 모집단의 모평균 검정
 │   │    ├─ 분산을 아는 경우  →  Z 검정
 │   │    └─ 분산을 모르는 경우 →  t 검정
 │   ├─ 두 모집단의 모평균 차이 검정
 │   │    ├─ 독립 표본         →  t 검정
 │   │    └─ 대응 표본         →  t 검정
 │   └─ 세 모집단 이상의 모평균 차이 검정
 │        → ANOVA
 └─ 정규분포를 따르지 않는 경우
      → 비모수적 가설 검정


■  [Z 검정 (Z-test)]

1. 정의:
   - 모집단의 분산(σ²)을 알고 있을 때 사용하는 검정 방법.
   - 표본의 크기가 큰 경우(n ≥ 30), 중심극한정리에 의해 표본평균이 정규분포를 따른다고 볼 수 있음.

2. 특징:
   - 검정통계량은 표준정규분포(Z ~ N(0,1))를 따름.
   - Z 검정에서는 모집단의 분산(또는 표준편차)이 알려져 있어야 함.

3. 예시:
   - 모집단의 분산이 이미 알려진 경우
   - 표본의 크기가 충분히 큰 경우(n ≥ 30)


■  [검정통계량 (Z-test)]

1. 검정통계량 공식:
   Z = ( X̄ - μ₀ ) / ( σ / √n )

   여기서:
   - X̄ : 표본평균
   - μ₀ : 귀무가설에서 제시된 모평균
   - σ  : 모표준편차
   - n  : 표본 크기

2. 가설 설정

   1) 양측검정 (Two-sided test)
      - 귀무가설(H₀): μ = μ₀
      - 대립가설(H₁): μ ≠ μ₀

   2) 우측검정 (Right-tailed test)
      - 귀무가설(H₀): μ ≤ μ₀
      - 대립가설(H₁): μ > μ₀

   3) 좌측검정 (Left-tailed test)
      - 귀무가설(H₀): μ ≥ μ₀
      - 대립가설(H₁): μ < μ₀



문제1. 모평균의 95% 신뢰구간을 구하는 식에서 Z값은? (2022년 제5회 빅데이터분석기사 필기)

1. 1.645
2. 1.96
3. 2.58
4. 3.00

정답: 



문제1. 어떤 공장에서 생산되는 제품의 무게는 평균이 500g이고 표준편차가 10g인 정규분포를 따른다고 한다. 
      새로운 생산 방식을 도입한 후 임의로 36개의 제품을 추출하여 측정한 결과 평균이 503g이 나왔다. 
      새로운 생산 방식이 제품의 평균 무게를 변화시켰다고 할 수 있는가? (α = 0.05)

[문제 요약: 제품 품질 관리]

- 모집단: 제품 무게는 정규분포를 따르며,
  평균 (μ₀) = 500g, 표준편차 (σ) = 10g.

- 새 생산 방식 도입 후, n = 36개의 제품 표본에서
  표본평균 (X̄) = 503g 측정됨.

- 가설 설정 (양측검정):
    귀무가설(H₀): μ = 500g
    대립가설(H₁): μ ≠ 500g

- 유의수준: α = 0.05

검정통계량 (Z):
    Z = (X̄ - μ₀) / (σ / √n)
      = (503 - 500) / (10 / √36)
      = 3 / (10/6)
      = 3 / 1.6667 ≈ 1.80

- 임계값 (양측검정, α=0.05): ±1.96
  → |1.80| < 1.96 이므로 귀무가설을 기각할 수 없음.

결론:

  새 생산 방식이 제품의 평균 무게를 변화시켰다고 볼 충분한 증거가 없음.


[파이썬 코드 예제]




문제2. 한 제약회사에서 생산하는 진통제의 유효성분 함량은 평균이 50mg이고 표준편차가 2mg인 정규분포를 따른다.
      품질 관리자가 무작위로 49개의 진통제를 선택하여 검사한 결과 평균 함량이 49.5mg으로 나타났다. 
      유의수준 1%에서 이 진통제의 유효성분 함량이 감소했다고 할 수 있는가?


[문제 요약: 진통제 유효성분 함량 검정]

1. 배경:
   - 진통제의 유효성분 함량은 정규분포를 따르며,
     모평균 (μ₀) = 50 mg, 모표준편차 (σ) = 2 mg.

2. 표본:
   - 무작위로 선택된 49개의 진통제에서 표본평균 (X̄) = 49.5 mg 측정됨.

3. 가설 설정 (좌측검정):
   - 귀무가설 (H₀): μ = 50 mg   (유효성분 함량이 감소하지 않았다)
   - 대립가설 (H₁): μ < 50 mg   (유효성분 함량이 감소했다)

4. 검정 방법:
   - 모분산이 알려져 있고 표본 크기가 충분히 크므로 Z 검정을 사용함.
   - 검정통계량 공식:
     
         Z = (X̄ - μ₀) / (σ / √n)
     
5. 검정통계량 계산:
   - Z = (49.5 - 50) / (2 / √49)
       = (-0.5) / (2/7)
       = (-0.5) / (0.2857)
       ≈ -1.75

6. 유의수준:
   - α = 0.01 (1%)

7. 임계값:
   - 좌측검정에서 임계값은 약 Z = -2.33

8. 결론:
   - 계산된 Z 값 (-1.75)은 임계값 (-2.33)보다 크므로 귀무가설을 기각할 수 없음.
   - 따라서, 1% 유의수준에서 진통제의 유효성분 함량이 감소했다고 결론 내릴 충분한 증거가 없다.


[파이썬 코드 예제]




문제3. 한 연구팀이 새로운 혈압약이 평균 혈압을 증가시키는지 여부를 검정하려고 한다.
과거 연구에서 이 혈압약을 복용하지 않은 사람들의 평균 수축기 혈압은 120mmHg이며, 표준편차는 8mmHg로 알려져 있다.
새로운 혈압약을 복용한 50명의 환자를 대상으로 실험한 결과, 이들의 평균 혈압은 122.5mmHg였다.
유의수준 0.05 에서 혈압 증가 효과가 있는지 우측검정을 수행하라.

[문제 요약: 혈압 증가 효과 검정]

1. 배경:
   - 기존 (약 미복용) 평균 혈압: μ₀ = 120 mmHg, 모표준편차 σ = 8 mmHg (정규분포)
   - 새 혈압약 복용 후: 표본 크기 n = 50, 표본평균 X̄ = 122.5 mmHg

2. 가설 설정 (우측검정):
   - 귀무가설 (H₀): μ = 120 mmHg (새 혈압약이 혈압에 영향이 없다)
   - 대립가설 (H₁): μ > 120 mmHg (새 혈압약이 혈압을 증가시킨다)

3. 검정 방법:
   - Z 검정 사용 (모집단의 표준편차가 알려져 있으므로)
   - 검정통계량 공식:
     
         Z = (X̄ - μ₀) / (σ / √n)

4. 검정통계량 계산:
   - Z = (122.5 - 120) / (8 / √50)
   - √50 ≈ 7.071, 따라서 8 / 7.071 ≈ 1.1314
   - Z ≈ 2.5 / 1.1314 ≈ 2.21

5. 임계값 및 결정:
   - 우측검정, 유의수준 α = 0.05에서 임계값은 약 Z = 1.645
   - 계산된 Z (≈ 2.21) > 임계값 (1.645) → 귀무가설 기각

6. 결론:
   - 충분한 증거가 있으므로, 새 혈압약이 혈압을 증가시킨다고 결론 내릴 수 있다.

--------------------------------
[파이썬 코드 예제]




