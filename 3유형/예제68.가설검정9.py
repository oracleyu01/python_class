■ 예제68. 가설검정9. 카이제곱 검정

--------------------------------
[카이제곱 검정 이론 정리]

1. 정의:
   - 카이제곱 검정(Chi-square test)은 범주형 데이터를 대상으로 관측 빈도와 기대 빈도의 차이를 비교하여,
     변수 간의 독립성 또는 표본 분포가 특정 이론 분포를 따르는지를 검정하는 비모수적 방법입니다.
   
2. 주요 유형:
   a. 독립성 검정 (Chi-square test of independence)
      - 두 범주형 변수 간의 관련성(독립성 여부)을 검정합니다.
   b. 적합도 검정 (Chi-square goodness-of-fit test)
      - 표본 집단의 분포가 주어진 특정 이론 분포(예: 균등분포, 정규분포 등)를 따르는지를 검정합니다.
      
3. 검정 통계량:
      χ² = Σ[(관측빈도 - 기대빈도)² / 기대빈도]
   - 관측빈도와 기대빈도의 차이가 클수록 검정 통계량이 커집니다.
   - 검정 통계량은 음수가 될 수 없으며, 표본 크기나 기대빈도의 크기에 영향을 받습니다.

4. 특징:
   - 범주형 데이터를 다루며, 연속형 데이터에는 부적합합니다.
   - 기대빈도가 충분히 큰 경우(보통 5 이상) 사용이 권장되며, 작은 경우에는 검정의 신뢰도가 떨어질 수 있습니다.

--------------------------------
[기출문제 정리]

● 문제 1 (2022년 제4회 빅데이터분석기사 필기)
   - 문제: 카이제곱 검정에 대한 설명으로 옳은 것은?
         ① 연속형 데이터에 주로 사용된다
         ② 표본 크기에 상관없이 항상 정확한 결과를 제공한다
         ③ 기대빈도가 작은 경우에도 문제없이 사용할 수 있다
         ④ 범주형 데이터의 독립성을 검정하는 데 사용된다



   - 정답: 
   - 해설: 카이제곱 검정은 범주형 데이터를 대상으로 하며, 두 변수 간 독립성 여부를 검정하는 데 적합합니다.

● 문제 2 (2021년 제2회 기출문제)
   - 문제: 카이제곱 검정 통계량에 대한 설명으로 옳은 것은?
         ① 관측빈도와 기대빈도가 같을수록 카이제곱 값이 커진다
         ② 카이제곱 검정 통계량은 항상 음수 값을 가진다
         ③ 관측빈도와 기대빈도의 차이가 클수록 카이제곱 값이 커진다
         ④ 카이제곱 검정 통계량은 표본 크기에 영향을 받지 않는다



   - 정답: 
   - 해설: 관측빈도와 기대빈도의 차이가 클수록 (즉, 실제 데이터와 이론적 분포 간 차이가 클수록) 카이제곱 통계량은 커집니다.

● 문제 3 (2023년 제1회 기출문제)
   - 문제: 카이제곱 적합도 검정에 대한 설명으로 옳은 것은?
         ① 두 범주형 변수 간의 관계를 분석하는 데 사용된다
         ② 표본 집단의 분포가 주어진 특정 이론을 따르고 있는지를 검정하는 기법이다
         ③ 연속형 변수의 정규성을 검정하는 데 가장 적합하다
         ④ 두 집단 간의 평균 차이를 검정하는 데 사용된다


   - 정답: 
   - 해설: 카이제곱 적합도 검정은 표본 분포가 특정 이론적 분포와 일치하는지를 평가하는 데 사용됩니다.

--------------------------------
[파이썬 코드 예제: 카이제곱 검정]

# 예제: 기대빈도와 관측빈도를 이용하여 카이제곱 적합도 검정을 수행하는 코드

import numpy as np
from scipy import stats

# 예제 데이터:
# 총 관측 건수: 100
# 기대 비율: [20%, 30%, 25%, 25%] -> 기대 빈도: [20, 30, 25, 25]




--------------------------------
[파이썬 문제]

문제:
  다음의 기대빈도와 관측빈도를 이용하여 카이제곱 검정을 수행하시오.
  
  - 총 관측 건수: 200
  - 기대 비율: [10%, 20%, 30%, 40%] → 기대 빈도: [20, 40, 60, 80]
  - 관측 빈도: [25, 35, 55, 85]
  
  유의수준 α = 0.05에서, 카이제곱 검정 통계량과 p-value를 계산하고,
  검정 결과(귀무가설 채택/기각)를 출력하는 파이썬 코드를 작성하시오.


