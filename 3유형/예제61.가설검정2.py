
ì˜ˆì œ61. ê°€ì„¤ê²€ì •2.ë‹¨ì¼ ëª¨ì§‘ë‹¨ì˜ ëª¨í‰ê·  ê²€ì •: ë¶„ì‚°ì„ ì•„ëŠ” ê²½ìš°(Z ê²€ì •):

â–  ì˜ˆì œ61.ê°€ì„¤ê²€ì •2.ë‹¨ì¼ ëª¨ì§‘ë‹¨ì˜ ëª¨í‰ê·  ê²€ì •: ë¶„ì‚°ì„ ì•„ëŠ” ê²½ìš°(Z ê²€ì •)

â–  [ê°€ì„¤ê²€ì • ì „ì²´ ]

ê°€ì„¤ê²€ì •
 â”œâ”€ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ëŠ” ê²½ìš°
 â”‚   â”œâ”€ ë‹¨ì¼ ëª¨ì§‘ë‹¨ì˜ ëª¨í‰ê·  ê²€ì •
 â”‚   â”‚    â”œâ”€ ë¶„ì‚°ì„ ì•„ëŠ” ê²½ìš°  â†’  Z ê²€ì •  <---  ğŸ˜Š ì´ ë¶€ë¶„ì„ í•˜ê³  ìˆì–´ìš”
 â”‚   â”‚    â””â”€ ë¶„ì‚°ì„ ëª¨ë¥´ëŠ” ê²½ìš° â†’  t ê²€ì •
 â”‚   â”œâ”€ ë‘ ëª¨ì§‘ë‹¨ì˜ ëª¨í‰ê·  ì°¨ì´ ê²€ì •
 â”‚   â”‚    â”œâ”€ ë…ë¦½ í‘œë³¸         â†’  t ê²€ì •
 â”‚   â”‚    â””â”€ ëŒ€ì‘ í‘œë³¸         â†’  t ê²€ì •
 â”‚   â””â”€ ì„¸ ëª¨ì§‘ë‹¨ ì´ìƒì˜ ëª¨í‰ê·  ì°¨ì´ ê²€ì •
 â”‚        â†’ ANOVA
 â””â”€ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ” ê²½ìš°
      â†’ ë¹„ëª¨ìˆ˜ì  ê°€ì„¤ ê²€ì •


â–   [Z ê²€ì • (Z-test)]

1. ì •ì˜:
   - ëª¨ì§‘ë‹¨ì˜ ë¶„ì‚°(ÏƒÂ²)ì„ ì•Œê³  ìˆì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ê²€ì • ë°©ë²•.
   - í‘œë³¸ì˜ í¬ê¸°ê°€ í° ê²½ìš°(n â‰¥ 30), ì¤‘ì‹¬ê·¹í•œì •ë¦¬ì— ì˜í•´ í‘œë³¸í‰ê· ì´ ì •ê·œë¶„í¬ë¥¼ 
     ë”°ë¥¸ë‹¤ê³  ë³¼ ìˆ˜ ìˆìŒ.

2. íŠ¹ì§•:
   - ê²€ì •í†µê³„ëŸ‰ì€ í‘œì¤€ì •ê·œë¶„í¬(Z ~ N(0,1))ë¥¼ ë”°ë¦„.
   - Z ê²€ì •ì—ì„œëŠ” ëª¨ì§‘ë‹¨ì˜ ë¶„ì‚°(ë˜ëŠ” í‘œì¤€í¸ì°¨)ì´ ì•Œë ¤ì ¸ ìˆì–´ì•¼ í•¨.

3. ì˜ˆì‹œ:
   - ëª¨ì§‘ë‹¨ì˜ ë¶„ì‚°ì´ ì´ë¯¸ ì•Œë ¤ì§„ ê²½ìš°
   - í‘œë³¸ì˜ í¬ê¸°ê°€ ì¶©ë¶„íˆ í° ê²½ìš°(n â‰¥ 30)


â–   [ê²€ì •í†µê³„ëŸ‰ (Z-test)]

1. ê²€ì •í†µê³„ëŸ‰ ê³µì‹:
   Z = ( XÌ„ - Î¼â‚€ ) / ( Ïƒ / âˆšn )

   ì—¬ê¸°ì„œ:
   - XÌ„ : í‘œë³¸í‰ê· 
   - Î¼â‚€ : ê·€ë¬´ê°€ì„¤ì—ì„œ ì œì‹œëœ ëª¨í‰ê· 
   - Ïƒ  : ëª¨í‘œì¤€í¸ì°¨
   - n  : í‘œë³¸ í¬ê¸°

2. ê°€ì„¤ ì„¤ì •

   1) ì–‘ì¸¡ê²€ì • (Two-sided test)
      - ê·€ë¬´ê°€ì„¤(Hâ‚€): Î¼ = Î¼â‚€
      - ëŒ€ë¦½ê°€ì„¤(Hâ‚): Î¼ â‰  Î¼â‚€

   2) ìš°ì¸¡ê²€ì • (Right-tailed test)
      - ê·€ë¬´ê°€ì„¤(Hâ‚€): Î¼ â‰¤ Î¼â‚€
      - ëŒ€ë¦½ê°€ì„¤(Hâ‚): Î¼ > Î¼â‚€

   3) ì¢Œì¸¡ê²€ì • (Left-tailed test)
      - ê·€ë¬´ê°€ì„¤(Hâ‚€): Î¼ â‰¥ Î¼â‚€
      - ëŒ€ë¦½ê°€ì„¤(Hâ‚): Î¼ < Î¼â‚€



ë¬¸ì œ1. ëª¨í‰ê· ì˜ 95% ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•˜ëŠ” ì‹ì—ì„œ Zê°’ì€? (2022ë…„ ì œ5íšŒ ë¹…ë°ì´í„°ë¶„ì„ê¸°ì‚¬ í•„ê¸°)

1. 1.645
2. 1.96
3. 2.58
4. 3.00

ì •ë‹µ:  2

í•´ì„¤ì„¤ëª…: https://github.com/oracleyu01/python_class/blob/main/3ìœ í˜•/ê·¸ë¦¼/zê°’.png

íŒŒì´ì¬ìœ¼ë¡œ ìœ„ì˜ ë¬¸ì œì˜ ë‹µì„ í™•ì¸í•˜ê³  ì‹¶ë‹¤ë©´  ë‹¤ìŒê³¼ ê°™ì´ ì½”ë”©í•©ë‹ˆë‹¤.

from scipy.stats import norm

# ì‹ ë¢°ìˆ˜ì¤€ 95%ì—ì„œ Z ê°’ (ì–‘ì¸¡ê²€ì •)

z_value = norm.ppf(1 - 0.05 / 2)  # 1 - (1 - 0.95) / 2

print('95%ì˜ ì‹ ë¢°êµ¬ê°„ì˜ Z ê°’:', z_value)

95%ì˜ ì‹ ë¢°êµ¬ê°„ì˜ Z ê°’: 1.959963984540054
 
ë¬¸ì œ1. ì‹ ë¢°ìˆ˜ì¤€ 99%ì—ì„œì˜ z ê°’(ì–‘ì¸¡ê²€ì •) ì„ êµ¬í•˜ì‹œì˜¤ 

from scipy.stats import norm

# ì‹ ë¢°ìˆ˜ì¤€ 99%ì—ì„œ Z ê°’ (ì–‘ì¸¡ê²€ì •)

z_value = norm.ppf(1 - 0.01 / 2)  # 1 - (1 - 0.95) / 2

print('95%ì˜ ì‹ ë¢°êµ¬ê°„ì˜ Z ê°’:', z_value)



ë¬¸ì œ1. ì–´ë–¤ ê³µì¥ì—ì„œ ìƒì‚°ë˜ëŠ” ì œí’ˆì˜ ë¬´ê²ŒëŠ” í‰ê· ì´ 500gì´ê³  í‘œì¤€í¸ì°¨ê°€ 
        10gì¸ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  í•œë‹¤. 

        ìƒˆë¡œìš´ ìƒì‚° ë°©ì‹ì„ ë„ì…í•œ í›„ ì„ì˜ë¡œ 36ê°œì˜ ì œí’ˆì„ ì¶”ì¶œí•˜ì—¬ ì¸¡ì •í•œ ê²°ê³¼ í‰ê· ì´ 503gì´ ë‚˜ì™”ë‹¤. 
        ìƒˆë¡œìš´ ìƒì‚° ë°©ì‹ì´ ì œí’ˆì˜ í‰ê·  ë¬´ê²Œë¥¼ ë³€í™”ì‹œì¼°ë‹¤ê³  í•  ìˆ˜ ìˆëŠ”ê°€? (Î± = 0.05)


ê·€ë¬´ê°€ì„¤:  ìƒˆë¡œìš´ ìƒì‚° ë°©ì‹ì´ ì œí’ˆì˜ í‰ê· ë¬´ê²Œë¥¼ ë³€í™”ì‹œí‚¤ì§€ ì•Šì•˜ë‹¤.

 H0(Î¼) = 500

ëŒ€ë¦½ê°€ì„¤: ìƒˆë¡œìš´ ìƒì‚° ë°©ì‹ì´ ì œí’ˆì˜ í‰ê·  ë¬´ê²Œë¥¼ ë³€í™”ì‹œì¼°ë‹¤

 H0(Î¼) != 500


ë‹µ:

# ê·€ë¬´ê°€ì„¤:  ìƒˆë¡œìš´ ìƒì‚° ë°©ì‹ì´ ì œí’ˆì˜ í‰ê· ë¬´ê²Œë¥¼ ë³€í™”ì‹œí‚¤ì§€ ì•Šì•˜ë‹¤.

#  H0(Î¼) = 500

# ëŒ€ë¦½ê°€ì„¤: ìƒˆë¡œìš´ ìƒì‚° ë°©ì‹ì´ ì œí’ˆì˜ í‰ê·  ë¬´ê²Œë¥¼ ë³€í™”ì‹œì¼°ë‹¤

#  H0(Î¼) != 500

import  numpy  as  np
import  scipy.stats  as  stats
import  matplotlib.pyplot  as plt

#í•œê¸€ í°íŠ¸ ì„¤ì • 
plt.rc('font', family='Malgun Gothic')  # ìœˆë„ìš° ì‚¬ìš©ìì´ í•œê¸€ê¹¨ì§ ë°©ì§€ 
#plt.rc('font', family='Apple Gothic')  #ë§¥ ì‚¬ìš©ì
plt.rcParams['axes.unicode_minus'] = False  # ë§ˆì´ë„ˆìŠ¤ ê¸°í˜¸ ê¹¨ì§ ë°©ì§€ 

# ë°ì´í„° ì„¤ì •
# ë¬¸ì œ1. ì–´ë–¤ ê³µì¥ì—ì„œ ìƒì‚°ë˜ëŠ” ì œí’ˆì˜ ë¬´ê²ŒëŠ” í‰ê· ì´ 500gì´ê³  í‘œì¤€í¸ì°¨ê°€ 
# 10gì¸ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  í•œë‹¤. 

# ìƒˆë¡œìš´ ìƒì‚° ë°©ì‹ì„ ë„ì…í•œ í›„ ì„ì˜ë¡œ 36ê°œì˜ ì œí’ˆì„ ì¶”ì¶œí•˜ì—¬ ì¸¡ì •í•œ ê²°ê³¼
# í‰ê· ì´ 503gì´ ë‚˜ì™”ë‹¤. 
# ìƒˆë¡œìš´ ìƒì‚° ë°©ì‹ì´ ì œí’ˆì˜ í‰ê·  ë¬´ê²Œë¥¼ ë³€í™”ì‹œì¼°ë‹¤ê³  í•  ìˆ˜ ìˆëŠ”ê°€? (Î± = 0.05)

n = 36  #í‘œë³¸ì˜ ê°¯ìˆ˜ 
mu_sample=503  # í‘œë³¸í‰ê· 
sigma = 10  # ëª¨ì§‘ë‹¨ì˜ í‘œì¤€í¸ì°¨ 
mu_pop = 500  # ëª¨ì§‘ë‹¨ì˜ í‰ê·  

# ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ëŠ” í‘œë³¸ ìƒì„± 
import numpy as  np
np.random.seed(123)
sample_data = np.random.normal(loc=mu_sample, scale=sigma, size= n)
sample_data = mu_sample + (sample_data - sample_data.mean()) / sample_data.std() * sigma
sample_data  # 36ê°œì˜ í‘œë³¸ 

# Zê²€ì • í†µê³„ëŸ‰ê³¼ p_value êµ¬í•˜ê¸° 
#    Z = ( XÌ„ - Î¼â‚€ ) / ( Ïƒ / âˆšn )

z_stat =( np.mean(sample_data) - mu_pop ) / ( sigma / np.sqrt(n) )
p_value = 2 * ( 1- stats.norm.cdf(abs(z_stat))) #ì–‘ì¸¡ê²€ì •

# ì„ê³„ê°’ ê³„ì‚° 
alpha = 0.05
z_crit = stats.norm.ppf( 1 - alpha / 2 )

# ê²°ê³¼ í•´ì„
print('z ê²€ì • í†µê³„ëŸ‰' , round(z_stat, 5))
print('ì„ê³„ê°’ (z_crit) Â±', round(z_crit,5))
print('p_value ', round(p_value,5))

if abs(z_stat) > z_crit:
    print('ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•©ë‹ˆë‹¤')
    print('ìƒˆë¡œìš´ ìƒì‚°ë°©ì‹ì´ ì œí’ˆì˜ í‰ê· ë¬´ê²Œë¥¼ ë³€í™”ì‹œì¼°ë‹¤ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤')
else:
    print('ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤')

# ì‹œê°í™” 
x = np.linspace(-4, 4, 1000)
y = stats.norm.pdf(x)

plt.figure(figsize=(4,3))
plt.plot(x,y, label='í‘œì¤€ì •ê·œë¶„í¬',color='black')
plt.axvline(z_crit, color='red', linestyle='dashed', label=f"ì„ê³„ê°’ ({z_crit:.2f})")
plt.axvline(-z_crit, color='red', linestyle='dashed', label=f"ì„ê³„ê°’ (-{z_crit:.2f})")
plt.axvline(z_stat, color='blue', linestyle='solid', label=f"ê²€ì •í†µê³„ëŸ‰ ({z_stat:.2f})")

# xì¶•ì— í…ìŠ¤íŠ¸ ì¶”ê°€ (ê²€ì •í†µê³„ëŸ‰ê³¼ ì„ê³„ê°’ ì¶”ê°€)
plt.text(z_crit,-0.1,f"{z_crit:.2f}", color='red', ha='center', fontsize=10)
plt.text(-z_crit,-0.1,f"-{z_crit:.2f}", color='red', ha='center', fontsize=10)
plt.text(z_stat,-0.13,f"{z_stat:.2f}", color='blue', ha='center', fontsize=10)

plt.legend()
plt.title('z-ê²€ì • ê²°ê³¼ ì‹œê°í™”')
plt.xlabel('zê°’')
plt.ylabel('í™•ë¥ ë°€ë„í•¨ìˆ˜')
plt.show()

ë¬¸ì œ2. í•œ ì œì•½íšŒì‚¬ì—ì„œ ìƒì‚°í•˜ëŠ” ì§„í†µì œì˜ ìœ íš¨ì„±ë¶„ í•¨ëŸ‰ì€ í‰ê· ì´ 50mgì´ê³  
         í‘œì¤€í¸ì°¨ê°€ 2mgì¸  ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.
         í’ˆì§ˆ ê´€ë¦¬ìê°€ ë¬´ì‘ìœ„ë¡œ 49ê°œì˜ ì§„í†µì œë¥¼ ì„ íƒí•˜ì—¬ ê²€ì‚¬í•œ ê²°ê³¼ í‰ê·  í•¨ëŸ‰ì´ 
         49.5mgìœ¼ë¡œ ë‚˜íƒ€ë‚¬ë‹¤. 
        ìœ ì˜ìˆ˜ì¤€ 1%ì—ì„œ ì´ ì§„í†µì œì˜ ìœ íš¨ì„±ë¶„ í•¨ëŸ‰ì´ ê°ì†Œí–ˆë‹¤ê³  í•  ìˆ˜ ìˆëŠ”ê°€?

# 1. ê°€ì„¤ì„¤ì •

#ê·€ë¬´ê°€ì„¤ (H0): ì§„í†µì œì˜ ìœ íš¨ì„±ë¶„ í•¨ëŸ‰ì€ í‰ê· ì´ 50mg ì´ë‹¤.(ë³€í™”ì—†ìŒ)
#  H0:  Î¼ = 50

#ëŒ€ë¦½ê°€ì„¤ (H1): ì§„í†µì œì˜ ìœ íš¨ì„±ë¶„ í‰ê·  í•¨ëŸ‰ì´ ê°ì†Œí–ˆë‹¤.
#  H1:  Î¼ < 50 ( ë‹¨ì¸¡ê²€ì •, ì¢Œì¸¡ê²€ì •)


# 2. ë¬¸ì œì—ì„œ ì£¼ì–´ì§„ ê°’ ì„¤ì • 

n = 49  # í‘œë³¸í¬ê¸°
mu_sample = 49.5      #í‘œë³¸í‰ê· 
sigma =  2      # ëª¨ì§‘ë‹¨ í‘œì¤€í¸ì°¨ 
mu_pop =  50   # ëª¨ì§‘ë‹¨ í‰ê·  
alpha  =   0.01    # ìœ ì˜ìˆ˜ì¤€

# 3. z ê²€ì • ìˆ˜í–‰( ì¢Œì¸¡ ê²€ì •)
#    Z = ( XÌ„ - Î¼â‚€ ) / ( Ïƒ / âˆšn )

z_stat =( np.mean(mu_sample) - mu_pop ) / ( sigma / np.sqrt(n) )
p_value = stats.norm.cdf(z_stat)  # ì¢Œì¸¡ê²€ì •ì´ë¯€ë¡œ ëˆ„ì ë¶„í¬í•¨ìˆ˜(cdf) ì‚¬ìš©

# 3. z ê²€ì • ìˆ˜í–‰( ì¢Œì¸¡ ê²€ì •)
#    Z = ( XÌ„ - Î¼â‚€ ) / ( Ïƒ / âˆšn )

z_stat =( np.mean(mu_sample) - mu_pop ) / ( sigma / np.sqrt(n) )
p_value = stats.norm.cdf(z_stat)  # ì¢Œì¸¡ê²€ì •ì´ë¯€ë¡œ ëˆ„ì ë¶„í¬í•¨ìˆ˜(cdf) ì‚¬ìš©

# ì„ê³„ê°’ ê³„ì‚° 
alpha = 0.01
z_crit = stats.norm.ppf(alpha)
z_crit


# 4. ê²°ê³¼ í•´ì„
print('z ê²€ì • í†µê³„ëŸ‰' , round(z_stat, 5))
print('ì„ê³„ê°’ (z_crit)', round(z_crit,5))
print('p_value ', round(p_value,5))

if    z_stat < z_crit:
    print('ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•©ë‹ˆë‹¤')
    print('ìœ íš¨ì„±ë¶„í•¨ëŸ‰ì´ ê°ì†Œí–ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆìŒ')
else:
    print('ê·€ë¬´ê°€ì„¤ ì±„íƒ- ìœ íš¨ì„±ë¶„í•¨ëŸ‰ì´ ê°ì†Œí–ˆë‹¤ê³  ë³´ê¸° ì–´ë ¤ì›€')


# ì‹œê°í™” 
x = np.linspace(-4, 4, 1000)
y = stats.norm.pdf(x)

plt.figure(figsize=(4,3))
plt.plot(x,y, label='í‘œì¤€ì •ê·œë¶„í¬',color='black')
plt.axvline(z_crit, color='red', linestyle='dashed', label=f"ì„ê³„ê°’ ({z_crit:.2f})")
#plt.axvline(-z_crit, color='red', linestyle='dashed', label=f"ì„ê³„ê°’ (-{z_crit:.2f})")
plt.axvline(z_stat, color='blue', linestyle='solid', label=f"ê²€ì •í†µê³„ëŸ‰ ({z_stat:.2f})")

# xì¶•ì— í…ìŠ¤íŠ¸ ì¶”ê°€ (ê²€ì •í†µê³„ëŸ‰ê³¼ ì„ê³„ê°’ ì¶”ê°€)
plt.text(z_crit,-0.1,f"{z_crit:.2f}", color='red', ha='center', fontsize=10)
#plt.text(-z_crit,-0.1,f"-{z_crit:.2f}", color='red', ha='center', fontsize=10)
plt.text(z_stat,-0.13,f"{z_stat:.2f}", color='blue', ha='center', fontsize=10)

plt.legend()
plt.title('z-ê²€ì • ê²°ê³¼ ì‹œê°í™”')
plt.xlabel('zê°’')
plt.ylabel('í™•ë¥ ë°€ë„í•¨ìˆ˜')
plt.show()

